<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8">
    <title>{% block title %}Личный кабинет врача{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Add additional CSS in static file -->
    {% load static %}
    <link rel="stylesheet" href="{% static 'doctor/css/all.css' %}">
    <style>
        .table input[type="radio"] {
            display: none;
        }
    </style>


</head>
<!-- Если на странице "меню" -->
{% if page == 'menu-menu' %}
<body>
<div data-modal="profile-form" data-modal-width="480">
            <div class="title">Редактировать профиль</div>
                <form id='profile-form-id' method="post" novalidate>
                    {% csrf_token %}
                    <div id='change-email-form' class="form-group">
                        <label for="#">E-mail</label>
                        <input id='change-email' type="text" value="{{ user.email }}">
                        <div id='change-email-error'></div>
                    </div>
                    <div class="form-group item-actions flex flex-center">
                        <button type="button" onclick="validationChangeEmailForm()">Сохранить</button>
                        <a class="button white" data-modal-link="password-form">Изменить пароль</a>
                    </div>
                    <input style="display: none;"
                           type="text"
                           id="changed-email"
                           name="changed-email">
                    <input style="display: none;"
                           type="checkbox"
                           id="change-email_flag"
                           name="change-email">
                    <input style="display: none;"
                           type="text"
                           id="changed-password"
                           name="changed-password">
                    <input style="display: none;"
                           type="checkbox"
                           id="change-password_flag"
                           name="change-password_flag">
                </form>
        </div>
    {% if type == 'menu_for_staff' %}
        <form id='form-get' action="{% url 'menu_for_staff' %}" method="get" novalidate>
    {% else %}
        <form id='form-get' action="{% url 'menu' %}" method="get" novalidate>
    {% endif %}

<!-- Если на странице "доктор" или "архив" -->
{% else %}
<script src="{% static 'doctor/js/moment.js' %}"></script>
<body  class="has-right">
    <div data-modal="profile-form" data-modal-width="480">
    <div class="title">Редактировать профиль</div>
    <form id='profile-form-id' method="post" novalidate>
        {% csrf_token %}
        <div id='change-email-form' class="form-group">
            <label for="#">E-mail</label>
            <input id='change-email' type="text" value="{{ user.email }}">
            <div id='change-email-error'></div>
        </div>
        <div class="form-group item-actions flex flex-center">
            <button type="button" onclick="validationChangeEmailForm()">Сохранить</button>
            <a class="button white" data-modal-link="password-form">Изменить пароль</a>
        </div> 
        <input style="display: none;"
               type="text"
               id="changed-email"
               name="changed-email">
        <input style="display: none;"
               type="checkbox"
               id="change-email_flag"
               name="change-email">
        <input style="display: none;"
               type="text"
               id="changed-password"
               name="changed-password">
        <input style="display: none;"
               type="checkbox"
               id="change-password_flag"
               name="change-password_flag">
    </form>
    </div>
    <form id='main-form' style='padding-left: 0px; padding-right: 0px;' method="post" novalidate>
        {% csrf_token %} 
{% endif %}

    {{ formset.management_form }}
        <div id="wrapper">
            <div id="left">
                <div class="sidebar-toggle-block" data-sidebar-toggle>
                    <div class="logo"></div>
                    <div class="arrow">
                        <div class="i i-arrow"></div>
                    </div>
                    <div class="petrushka"></div>
                </div>

                <div class="sidebar">
                    <div class="overlay" data-sidebar-toggle></div>
                    <div class="inner">
                        <div class="sidebar-header-block">
                            <a class="close" data-sidebar-toggle>
                                <span class="i i-close"></span>
                            </a>
                            <a href='https://hadassah.moscow/' class="logo">
                                {% load static %}
                                <img src="{% static 'doctor/css/img/logo.svg' %}" alt="">
                            </a>

                                <div class="profile">
                                    {% if type != 'menu_for_staff' %}
                                        <a  class="label" data-fade-toggle-link="profile-info">
                                            <span class="icon"></span>
                                            Профиль
                                        </a>
                                    {% endif %}
                                    <div class="info" data-fade-toggle="profile-info">
                                        <div class="segment">
                                            <div class="name">
                                                {{ user.first_name }}
                                                {{ user.last_name }}
                                            </div>
                                            <div class="email">{{ user.email }}</div>
                                            <div class="links">
                                                <a  data-modal-link="logout">Выйти</a>
                                                <a  data-modal-link="profile-form">Изменить</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            {% if type != 'menu_for_staff' %}
                                <div class="sidebar-menu-block">
                                    <p style="display: none;" id="page">{{ page }}</p>
                                    <ul>
                                        <li id='menu-doctor'>
                                            <a href="{% url 'doctor'  %}">
                                                <span class="i i-list icon-default"></span>
                                                <span class="i i-list-colored icon-colored"></span>
                                                <span>Пациенты</span>
                                            </a>
                                        </li>
                                        <li id='menu-menu'>
                                            <a href="{% url 'menu'  %}">
                                                <span class="i i-eat icon-default"></span>
                                                <span class="i i-eat-colored icon-colored"></span>
                                                <span>Меню</span>
                                            </a>
                                        </li>
                                        <li id='menu-archive'>
                                            <a href="{% url 'archive'  %}">
                                                <span class="i i-box icon-default"></span>
                                                <span class="i i-box-colored icon-colored"></span>
                                                <span>Архив</span>
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            {% endif %}

                            <div class="sidebar-petrushka-block">
                                <img src="{% static 'nutritionist/css/img/petrushka.png' %}" alt="">
                            </div>
                        </div>
                </div>
            </div>
        
        {% block content %}

        {% endblock %}

    {% load static %}
        </div>  <!-- div wrapper -->



        <div data-modal="profile-edited" data-modal-width="400">
            <div class="message-block">
                <div class="icon">
                    <div class="i i-ok"></div>
                </div>
                <div class="title">Email успешно изменён</div>
            </div>           
        </div>

        <div data-modal="password-edited" data-modal-width="400">
            <div class="message-block">
                <div class="icon">
                    <div class="i i-ok"></div>
                </div>
                <div class="title">Пароль успешно изменён</div>
            </div>
            <a href="{% url 'logout' %}"><button  title="Close (Esc)" type="button" class="mfp-close">×</button></a>
        </div>

        <div data-modal="password-form" data-modal-width="480">
            <div class="title">Изменение пароля</div>
                <div id='change-email-form-old-password' class="form-group">
                    <label for="#">Введите старый пароль</label>
                    <input  type="password" name="old_password" id="old_password">
                    <div id="old-password-error"></div>
                </div>
                <div id='change-email-form-new-password' class="form-group">
                    <label for="#">Введите новый пароль</label>
                    <input  type="password" name="new_password" id="new_password">
                    <div id="new-password-error"></div>
                </div>
                <div class="form-group item-actions flex flex-center">
                    <button name="change_patient" onclick="validationChangePasswordForm()">Сохранить</button>
                </div>
        </div>

        <div data-modal="patient-add-test" data-modal-width="480">
            <input id="test_full_name" type="text" name="full_name" value="">
            <input id="test_birthdate" type="text" name="birthdate" value="">
            <input id="test_floor" type="text" name="floor" value="">
            <input id="test_receipt_date" type="text" name="receipt_date" value="">
            <input id="test_receipt_time" type="text" name="receipt_time" value="">
            <input id="test_department" name="department">
            <input id="test_type_of_diet" name="type_of_diet">
            <input id="test_room_number" name="room_number">
            <input id="test_bed" name="bed">
            <input id="test_comment" name="comment">
        </div>
        <div data-modal="patient-add-test1" data-modal-width="480">
            <input id="test1_full_name" type="text" name="full_name1">
            <input id="test1_birthdate" type="text" name="birthdate1">
            <input id="test1_floor" type="text" name="floor1">
            <input id="test1_receipt_date" type="text" name="receipt_date1">
            <input id="test1_receipt_time" type="text" name="receipt_time1">
            <input id="test1_department" type="text" name="department1">
            <input id="test1_type_of_diet" type="text" name="type_of_diet1">
            <input id="test1_room_number" type="text" name="room_number1">
            <input id="test1_bed" type="text" name="bed1">
            <input id="test1_comment" type="text" name="comment1">
        </div>

        <div  data-modal="patient-edited" data-modal-width="400">
            <div class="message-block">
                <div class="icon">
                    <div class="i i-ok"></div>
                </div>
                <div class="title">Учётная запись отредактирована</div>
            </div>
        </div>

        <div class="patient-add" data-modal="patient-add" data-modal-width="480">
            <div class="title">Добавить нового пациента</div>
                <div id ='full_name_add' class="form-group">
                    {{ user_form.full_name.label }}
                    {{ user_form.full_name }}
                    <div id ='error_full_name' class="error-field"></div>
                </div>
                <div id='birthdate_add' class="form-group">
                    {% load widget_tweaks %}
                    {{ user_form.birthdate.label }}
                    {{ user_form.birthdate }}
                    <div id ='error_birthdate' class="error-field"></div>
                </div>
                <div id='receipt_date_add' class="form-group">
                    {% load widget_tweaks %}
                    {{ user_form.receipt_date.label }}
                    {{ user_form.receipt_date|attr:"data-datepicker" }}
                    <div id ='error_receipt_date' class="error-field"></div>
                </div>
                <div id='receipt_time_add' class="form-group">
                    {{ user_form.receipt_time.label }}
                    {{ user_form.receipt_time|attr:"data-timemask" }}
                    <div id ='error_receipt_time' class="error-field"></div>
                </div>
                <div id='type_of_diet_add' class="form-group">
                    {{ user_form.type_of_diet.label }}
                    {{ user_form.type_of_diet }}
                    <div id ='error_type_of_diet' class="error-field"></div>
                </div>
                <div id='department_add' class="form-group">
                    {{ user_form.department.label }}
                    <select name="department" id="id_department">
                        <option value="Не выбрано">Не выбрано</option>
                        <option value="Онкология">Онкология</option>
                        <option value="Хирургия">Хирургия</option>
                        <option value="Реанимация">Реанимация</option>
                        <option value="Интенсивная терапия">Интенсивная терапия</option>
                        <option value="Check-up">Check-up</option>
                     </select>
                    <div id ='error_department' class="error-field"></div>
                </div>
                <div id='floor_add' class="form-group">
                    <label>Этаж</label>
                    <select onchange="addRoomNumber(this.value, 'id_room_number')" name="floor" id="id_floor">
                        <option value="Не выбрано">Не выбрано</option>
                        <option value="2">2 этаж</option>
                        <option value="3">3 этаж</option>
                        <option value="4">4 этаж</option>
                     </select>
                    <div id ='error_floor' class="error-field"></div>
                </div>
                <div id='room_number_add' class="form-group hidden-edit">
                    {{ user_form.room_number.label }}
                    <select onchange="addBed(this.value)" name="room_number" id="id_room_number">
                    </select>
                    <div id ='error_room_number' class="error-field"></div>
                </div>
                <div id='bed_add' class="form-group hidden-edit">
                    {{ user_form.bed.label }}
                    <select onchange="checkBed(this.value)" name="bed" id="id_bed">
                    </select>
                    <div id ='error_bed' class="error-field"></div>
                </div>
                <div class="form-group">
                    {{ user_form.comment.label }}
                    {{ user_form.comment|attr:"rows='4'" }}
                    <div id ='error_receipt_date' class="error-field"></div>
                </div>

                <div class="form-group item-actions flex flex-center last_form_group">
                    <button name="add_patient" onclick="validationForm()">Сохранить</button>
                    <a class="button white" data-modal-close>Отменить</a>
                </div>
        </div>

        <div data-modal="patient-added" data-modal-width="400">
            <div class="message-block">
                <div class="icon">
                    <div class="i i-ok"></div>
                </div>
                <div class="title">Учётная запись создана</div>
                <div class="text">Пациент получит доступ к выбору рациона в личном кабинете по QR-коду в его палате</div>
            </div>
        </div>

        <div data-modal="logout" data-modal-width="400">
            <div class="title align-center">Вы уверены, что хотите выйти?</div>
            <div class="confirm-block">
                <div class="buttons">
                    <a class="button" href="{% url 'logout' %}">Выйти</a>
                    <a class="button white" data-modal-close>Отменить</a>
                </div>
            </div>
        </div>

        <div data-modal="patient-archive" data-modal-width="400">
            <div class="title align-center">Перенести учётную запись пациента в архив?</div>
            <div class="confirm-block">
                <div class="buttons">
                    <a  class="button" data-modal-link="patient-archived">Архивировать</a>
                    <a  class="button white" data-modal-close>Отменить</a>
                </div>
            </div>
        </div>

        <div id="123" class='test' data-modal="patient-archived" data-modal-width="400">
            <div class="message-block">
                <div class="icon">
                    <div class="i i-ok"></div>
                </div>
                <div class="title">Учётная запись архивирована</div>
            </div>
          </div>
    <script src="{% static 'doctor/js/all.js' %}"></script>
</form>
</body>
</html>